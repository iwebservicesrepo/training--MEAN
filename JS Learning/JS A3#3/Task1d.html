<!DOCTYPE html>
<html>
  <head>
    <title>Task 1d</title>
  </head>
  <body>
    Payment Options<br />
    <div id="payments"></div>
    <script>
      const paymentOptions = [
        {
          type: "Credit Card",
          providers: ["ICICI Bank", "HDFC Bank", "CitiBank", "SBI", "Amex"],
        },
        {
          type: "Net Banking",
          providers: ["SBI", "BoI", "HDFC Bank", "Axis Bank", "Kotak Bank"],
        },
        {
          type: "Wallet",
          providers: ["PayTM", "Google Pay", "Phone Pe", "Amazon Pay"],
        },
      ];
      showPaymentOptions();
      function showPaymentOptions() {
        const arr1 = paymentOptions.map(function (p1) {
          return p1.type;
        });
        let dd1 = makeDDFn(
          "dd1",
          arr1,
          "",
          "Select Payment Method",
          "payChange"
        );
        let div1 = document.getElementById("payments");
        div1.innerHTML = dd1;
      }
      function payChange(elem) {
        let selOpt = elem.value;
        const arr1 = paymentOptions.map(function (p1) {
          return p1.type;
        });
        let dd1 = makeDDFn(
          "dd1",
          arr1,
          selOpt,
          "Select Payment Method",
          "payChange"
        );
        let json1 = paymentOptions.find(function (p1) {
          return p1.type == selOpt;
        });
        let dd2 = makeDDFn("dd2", json1.providers, "", "Select", "");
        let div1 = document.getElementById("payments");
        div1.innerHTML = dd1 + dd2;
      }
      function makeDDFn(id, data, selectedVal, valOnTop, onChangeFn) {
        let dataMap = data.map(function (opt) {
          if (opt == selectedVal) {
            return "<option selected>" + opt + "</option>";
          } else {
            return "<option>" + opt + "</option>";
          }
        });
        let first = "<option value=''disabled>" + valOnTop + "</option>";
        if (selectedVal == "") {
          first = "<option value=''selected disabled>" + valOnTop + "</option>";
        }
        let ddHTML = "<select id='" + id + "'>";
        if (onChangeFn != "")
          ddHTML =
            "<select id='" + id + "' onchange='" + onChangeFn + "(this)'>";
        ddHTML += first + dataMap.join("") + "</select>";
        return ddHTML;
      }
    </script>
  </body>
</html>
